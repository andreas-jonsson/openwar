version: 0.0.0.{build}

platform: x64

branches:
    only:
        - master

clone_folder: c:\gopath\src\github.com\andreas-jonsson\openwar

environment:
    GOPATH: c:\gopath

install:
    - appveyor DownloadFile https://storage.googleapis.com/golang/go1.6.3.windows-amd64.msi
    - msiexec /i go1.6.3.windows-amd64.msi /q
    - go version
    - go env

    # - curl -fsS -o setup.exe http://www.jrsoftware.org/download.php/ispack-unicode.exe
    # - setup.exe /SILENT

    - appveyor DownloadFile https://github.com/andreas-jonsson/openwar/raw/master/tools/package/dependencies.7z
    - 7z.exe x dependencies.7z -oc:\gopath\src\github.com\andreas-jonsson\openwar\tools\package\dependencies

    - appveyor DownloadFile https://github.com/andreas-jonsson/openwar/raw/master/tools/build/TDM-GCC-64.7z
    - 7z.exe x TDM-GCC-64.7z -oc:\TDM-GCC-64
    - set PATH=%PATH%;c:\TDM-GCC-64\bin

build_script:
    - go get
    - go build openwar.go
    - go test ./...
